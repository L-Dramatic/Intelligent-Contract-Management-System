# SSH 连接问题排查指南

## 问题：SSH 连接超时

### 已确认
- ✅ 网络连通正常（ping 成功）
- ❌ SSH 端口 22 无法连接

### 解决方案

#### 1. 云服务器安全组配置（最重要！）

**阿里云：**
1. 登录阿里云控制台
2. 进入 **ECS** → **实例** → 找到你的服务器
3. 点击 **安全组** → **配置规则**
4. 点击 **添加安全组规则**
5. 配置：
   - 规则方向：入方向
   - 授权策略：允许
   - 协议类型：自定义 TCP
   - 端口范围：22/22
   - 授权对象：0.0.0.0/0（或你的IP）
6. 点击 **保存**

**腾讯云：**
1. 登录腾讯云控制台
2. 进入 **云服务器 CVM** → **实例**
3. 点击服务器 → **安全组** → **修改规则**
4. 添加入站规则：
   - 类型：自定义
   - 来源：0.0.0.0/0
   - 协议端口：TCP:22
   - 策略：允许
5. 保存

**华为云：**
1. 登录华为云控制台
2. 进入 **弹性云服务器 ECS** → **安全组**
3. 添加入方向规则：
   - 协议：TCP
   - 端口：22
   - 源地址：0.0.0.0/0
4. 保存

#### 2. 如果可以通过控制台访问服务器

在服务器上执行：

```bash
# 检查 SSH 服务状态
sudo systemctl status ssh
# 或
sudo systemctl status sshd

# 如果服务未运行，启动它
sudo systemctl start ssh
sudo systemctl enable ssh

# 检查防火墙（Ubuntu）
sudo ufw status
sudo ufw allow 22/tcp
sudo ufw reload

# 检查防火墙（CentOS）
sudo firewall-cmd --list-all
sudo firewall-cmd --permanent --add-service=ssh
sudo firewall-cmd --reload
```

#### 3. 验证连接

配置完安全组后，等待 1-2 分钟，然后重试：

```bash
ssh root@118.31.77.102
```

如果还是不行，可以尝试：

```bash
# 使用详细模式查看连接过程
ssh -v root@118.31.77.102

# 或指定端口（如果SSH改了端口）
ssh -p 22 root@118.31.77.102
```

### 常见问题

**Q: 安全组配置后还是连不上？**
A: 等待 1-2 分钟让规则生效，或者重启服务器。

**Q: 不知道是哪个云服务商？**
A: 查看服务器购买记录或账单，或者尝试登录各大云服务商控制台查找。

**Q: 没有 root 密码？**
A: 在云控制台重置密码，或者使用密钥对登录。

