# 🧪 智慧合同管理系统 - 审批流程测试手册

## 测试前准备

确保前端和后端都已启动。所有测试账号密码均为 `123456`

### 系统访问地址
- 前端地址：`http://localhost:5173`
- 后端地址：`http://localhost:8080`

---

## 📋 测试场景一：简单审批流程（推荐先测这个）

**场景**：土建工程合同，金额 5000 元  
**审批链**：县级发起 → 项目经理 → 部门经理（共2个审批节点）

### 步骤 1：县级员工起草合同

| 操作 | 说明 |
|------|------|
| 登录账号 | `c_net_user` |
| 进入页面 | 合同管理 → 起草合同 |
| 填写信息 | |
| - 合同名称 | 测试-XX基站土建工程 |
| - 合同类型 | TYPE_A（工程类） |
| - 合同金额 | **5000** |
| - 合同内容 | 基站机房土建施工合同... |
| 操作 | 点击"保存草稿" |
| 操作 | 点击"提交审批" |

**预期结果**：提示"提交成功"，合同状态变为"审批中"

### 步骤 2：查看任务分配

| 操作 | 说明 |
|------|------|
| 登录账号 | `a_pm`（A市项目经理） |
| 进入页面 | 工作台 或 我的任务 |
| 预期 | 能看到刚才提交的合同待审批任务 |

### 步骤 3：项目经理审批

| 操作 | 说明 |
|------|------|
| 当前账号 | `a_pm` |
| 操作 | 点击待办任务，进入审批详情 |
| 操作 | 填写审批意见，点击"通过" |

**预期结果**：任务流转到下一个审批人

### 步骤 4：部门经理审批

| 操作 | 说明 |
|------|------|
| 登录账号 | `a_net_mgr`（A市网络部经理） |
| 进入页面 | 我的任务 |
| 操作 | 审批通过 |

**预期结果**：合同状态变为"已生效" ✅

---

## 📋 测试场景二：完整审批流程

**场景**：土建工程合同，金额 80000 元（5万-50万档）  
**审批链**：发起 → 项目经理 → 成本审计 → 法务审查 → 部门经理 → 副总 → 总经理

### 步骤 1：起草并提交

| 操作 | 说明 |
|------|------|
| 登录账号 | `c_net_user` |
| 合同金额 | **80000** |
| 合同类型 | TYPE_A |
| 操作 | 保存并提交 |

### 步骤 2-7：依次登录审批

| 顺序 | 登录账号 | 角色 | 操作 |
|------|----------|------|------|
| 1 | `a_pm` | 项目经理 | 通过 |
| 2 | `a_cost_audit` | 成本审计员 | 通过 |
| 3 | `a_legal` | 法务审查员 | 通过 |
| 4 | `a_net_mgr` | 网络部经理 | 通过 |
| 5 | `a_vp` | 副总经理 | 通过 |
| 6 | `a_gm` | 总经理 | 通过 |

**最终结果**：合同状态变为"已生效" ✅

---

## 📋 测试场景三：驳回流程

**场景**：测试审批被驳回的情况

### 步骤 1：起草并提交

| 操作 | 说明 |
|------|------|
| 登录账号 | `c_gov_user`（C县政企部员工） |
| 合同金额 | 15000 |
| 合同类型 | TYPE_A |
| 操作 | 保存并提交 |

### 步骤 2：项目经理驳回

| 操作 | 说明 |
|------|------|
| 登录账号 | `a_pm` |
| 操作 | 点击"驳回"，填写驳回原因 |

**预期结果**：
- 合同状态变为"已驳回"
- 发起人 `c_gov_user` 可以看到驳回信息
- 发起人可以修改后重新提交

---

## 📋 测试场景四：管理员功能

**场景**：测试管理员的配置功能

| 登录账号 | `admin` |
|----------|---------|

### 测试功能清单

| 功能 | 操作说明 |
|------|----------|
| 用户管理 | 新建/编辑用户，分配部门和角色 |
| 组织架构 | 查看部门树结构 |
| 审批场景 | 查看/编辑审批流程配置 |
| 场景控制 | 禁用/启用某个审批场景 |

---

## 🔍 验证检查点

测试完成后，检查以下内容：

| 检查项 | 预期结果 |
|--------|----------|
| ✅ 合同提交后能正确匹配审批场景 | 根据类型+金额自动匹配 |
| ✅ 任务正确分配给对应角色的人员 | 按待办任务数量优先分配 |
| ✅ 审批通过后能流转到下一节点 | 自动派发给下一审批人 |
| ✅ 最后一个节点通过后合同生效 | 状态=已生效 |
| ✅ 驳回后合同状态变为已驳回 | 状态=已驳回 |
| ✅ 个人信息页面显示正确 | 无Z岗级显示 |

---

## 📱 快速测试路径

### 最快测试（5分钟）

```
c_net_user 起草(5000元) → a_pm 通过 → a_net_mgr 通过 → 完成
```

### 完整测试（15分钟）

```
c_net_user 起草(80000元) → a_pm → a_cost_audit → a_legal → a_net_mgr → a_vp → a_gm → 完成
```

---

## 📚 测试账号速查表

### 县级起草人

| 账号 | 姓名 | 部门 | 角色 |
|------|------|------|------|
| `c_net_user` | C县网络部员工 | C县网络部 | 网络工程师 |
| `c_gov_user` | C县政企部员工 | C县政企部 | DICT项目经理 |

### 市级审批人

| 账号 | 姓名 | 部门 | 角色 |
|------|------|------|------|
| `a_pm` | A市项目经理 | A市网络部 | 项目经理 |
| `a_net_eng` | A市网络工程师 | A市网络部 | 网络工程师 |
| `a_net_mgr` | A市网络部经理 | A市网络部 | 部门经理 |
| `a_legal` | A市法务审查员 | A市法务部 | 法务审查员 |
| `a_cost_audit` | A市成本审计员 | A市财务部 | 成本审计员 |
| `a_vp` | A市副总经理 | A市分公司 | 副总经理 |
| `a_gm` | A市总经理 | A市分公司 | 总经理 |

### 省级审批人

| 账号 | 姓名 | 部门 | 角色 |
|------|------|------|------|
| `p_legal` | 省法务审查员 | 省法务部 | 法务审查员 |
| `p_net_mgr` | 省网络部经理 | 省网络部 | 部门经理 |

### 系统管理员

| 账号 | 姓名 | 说明 |
|------|------|------|
| `admin` | 系统管理员 | 拥有所有管理权限 |

---

## 💡 建议

1. **先从测试场景一开始**，确认基本流程正常后再测试其他场景
2. 测试时可以打开**浏览器开发者工具**（F12）查看网络请求和控制台日志
3. 如果遇到问题，检查后端控制台的日志输出
4. 每个测试场景完成后，可以通过**合同列表**查看合同状态变化

---

*文档版本：v1.0*  
*更新日期：2025-01-06*

